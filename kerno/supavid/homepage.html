<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>SupaVid - Home</title>
    <link rel="stylesheet" href="style.css">
</head>
<body>
    <nav>
        <a href="homepage.html" class="logo">SupaVid</a>
        <div class="nav-links">
            <a href="upload.html">Upload</a>
            <a href="login.html">Login</a>
        </div>
    </nav>

    <div id="video-grid" class="grid">
        <p>Loading videos...</p>
    </div>
    
    <script src="https://cdn.jsdelivr.net/npm/@supabase/supabase-js@2"></script>

<script>
    // Force a message to appear immediately to prove the script is alive
    document.write('<div id="debug-log" style="color:yellow; background:black; padding:10px; font-family:monospace; font-size:12px;">Script started...</div>');

    function log(msg) {
        document.getElementById('debug-log').innerHTML += '<br>> ' + msg;
    }

    async function loadFeed() {
        const grid = document.getElementById('video-grid');
        
        try {
            // 1. Initialize (Use YOUR actual URL and Key)
            const supabaseUrl = 'https://xnvhixwirbpofdkyhtvf.supabase.co';
            const supabaseKey = 'eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6InhudmhpeHdpcmJwb2Zka3lodHZmIiwicm9sZSI6ImFub24iLCJpYXQiOjE3NjgyMzE0NzgsImV4cCI6MjA4MzgwNzQ3OH0.gg6cLfx1PrGTNKztWSqDy3U9W66mNCu6ln5WDDLpyVo';
            const supabase = window.supabase.createClient(supabaseUrl, supabaseKey);
            log("Supabase Client initialized.");

            // 2. Fetch
            const { data: videos, error } = await supabase
                .from('videos')
                .select('*');

            if (error) {
                log("DB Error: " + error.message);
                return;
            }

            log("Fetch successful. Rows found: " + (videos ? videos.length : 0));

            if (!videos || videos.length === 0) {
                grid.innerHTML = "Connected, but no videos in table.";
                return;
            }

            // 3. Render
            grid.innerHTML = videos.map(vid => `
                <div style="border:1px solid #333; margin:10px; padding:10px;">
                    <h3>${vid.title || 'Untitled'}</h3>
                    <p>ID: ${vid.id}</p>
                </div>
            `).join('');

        } catch (err) {
            log("CRASH: " + err.message);
        }
    }

    // Run after a tiny delay to ensure HTML is ready
    setTimeout(loadFeed, 500);
</script>

    
</body>
</html>